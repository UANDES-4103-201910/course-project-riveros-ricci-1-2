<%# Post %>
<div class="row">
  <div class="card" style="width: auto;">
    <div class="card-header">
      <%= render partial: 'shared/user_and_picture', locals: {user: @post.user} %>
      <%= render partial: 'shared/date_ago', locals: {html_class: 'text-muted float-right', date: @post.created_at} %>
      <%= link_to('Edit', edit_post_path(@post), class: 'btn btn-warning btn-sm float-right p-0 mr-2') if @current_user == @post.user %>
      <%= link_to(octicon("report"), new_post_flag_path(@post), class: 'btn btn-danger btn-sm float-right p-0 mr-2') if @current_user %>
      <% if @current_user && @current_user.follow_posts.where(post: @post).count > 0 %>
        <%= button_to 'Unfollow',  {controller: 'follow_posts', action: 'destroy', id: @current_user.follow_posts.where(post: @post).first },
                      method: :delete, form: { class: 'float-right' }, class: 'btn btn-warning btn-sm p-0 mr-2' %>
      <% elsif @current_user && @current_user != @post.user %>
        <%= button_to 'Follow', {controller: 'follow_posts', action: 'create', follow_post: { post_id: @post, user_id: @current_user } },
                      method: :post, form: { class: 'float-right' }, class: 'btn btn-success btn-sm p-0 mr-2' %>
      <% end %>
    </div>
    <svg class="bd-placeholder-img card-img-top" width="100%" height="180" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" focusable="false" role="img" aria-label="Placeholder: Image cap">
      <title>Placeholder</title>
      <rect width="100%" height="100%" fill="#868e96"></rect>
      <text x="50%" y="50%" fill="#dee2e6" dy=".3em">Image placeholder</text>
    </svg>
    <div class="card-body">
      <h5 class="card-title"><%= @post.description %></h5>
      <div class="card-text">
        <%= MarkdownParser.new(@post.content).markdown_to_html %>
      </div>
    </div>
    <div class="card-footer">
      <%# TODO: maybe a partial%>
      <span class='votes text-primary'><%= @post.score %></span>
      <span class='text-secondary'>points</span>
      <span class='comments text-primary'><%= @post.comments.count %></span>
      <span class='text-secondary'>comments</span>
      <a href=''>
        <%= octicon "arrow-up", :height => 34, :class => 'float-right'%>
      </a>
      <a href=''>
        <%= octicon("arrow-down", :height => 34, :class => "float-right")%>
      </a>
      <%= link_to('Add Comment', new_post_comment_path(@post), class: 'btn btn-success btn-sm float-right p-0 mr-2') %>
    </div>
  </div>
</div>
<div class="row mt-1">
  <% if @post.shared_files.count > 0 %>
    <div class="col-4 card">
      <a class="card-header ml-0" data-toggle="collapse" href="#attachmentCollapse">Attachments</a>
      <div class="card-body collapse" id="attachmentCollapse">
        <ul class="inline">
          <%#= TODO: Add link to each file %>
          <li><a href="#">File 1 link</a></li>
          <li><a href="#">File 2 link</a></li>
        </ul>
      </div>
    </div>
  <% end %>
</div>
<%# Comments  %>
<div id="comments">
  <%= render partial: 'comments/comment', collection: @post.comments, as: :comment %>
</div>
